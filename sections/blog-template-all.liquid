<header class="page__header">
  {% include 'breadcrumb' %}

  {% if section.settings.show_rss %}
    <div class="blog__rss">
      <div class="inner">
        <a href="{{ blog.url }}.atom">
          {{ 'blog.general.rss' | t }} {% include 'icon' with 'rss' %}
        </a>
      </div>
    </div>
  {% endif %}

  <div class="page__header-wrapper">
    <div class="container">
      <h1 class="page__title">{{ blog.title }}</h1>
    </div>
  </div>

  {% comment %} {% if section.settings.show_tags and blog.all_tags.size > 0 %}
    <div class="blog__tags">
      <div class="container">
        {% for tag in blog.all_tags %}
          {% if current_tags contains tag %}
            {% assign url_to_remove = tag | link_to_remove_tag: tag | split: 'href="' | last %}
            {% assign url_to_remove = url_to_remove | split: '">' %}

            <a class="blog__tag blog__tag--active" href="{{ url_to_remove | first }}">
              {{ tag }}

              <span class="icon-cross-container">
                {% include 'icon' with 'close' %}
              </span>
            </a>
          {% else %}
            {{ tag | link_to_add_tag: tag | replace: 'title=', 'class="blog__tag" title=' }}
          {% endif %}
        {% endfor %}
      </div>
    </div>
  {% endif %} {% endcomment %}
</header>

{% for block in section.blocks %}
  {% if block.type == 'blog_category' %}
    {% assign current_blog = blogs[block.settings.blog] %}
    {% if current_blog %}
        {% paginate current_blog.articles by block.settings.article_limit %}
        <div class="page__content">
          <div class="inner">
            <h2 class="article__title">{{ current_blog.title | link_to: current_blog.url }}</h2>
            <div class="grid grid--large grid--gallery grid--gallery-large">
              {% for article in current_blog.articles %}
                {% include 'article-preview', show_author: section.settings.show_author %}
              {% endfor %}
            </div>
          </div>
        </div>

        {% include 'pagination' %}
      {% endpaginate %}
    {% endif %}
  {% endif %}
{% endfor %}

{% comment %} {% paginate blog.articles by 9 %}
  <div class="page__content">
    <div class="inner">
      <div class="grid grid--large grid--gallery grid--gallery-large">
        {% for article in blog.articles %}
          {% include 'article-preview', show_author: section.settings.show_author %}
        {% endfor %}
      </div>
    </div>
  </div>

  {% include 'pagination' %}
{% endpaginate %} {% endcomment %}

{% schema %}
{
  "name": "All Blog page",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_author",
      "label": "Show author name",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_rss",
      "label": "Show RSS feed",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_tags",
      "label": "Show blog filter",
      "default": true
    }
  ],
  "blocks": [
      {
        "type": "blog_category",
        "name": "Blog Category",
        "settings": [
          {
            "type": "blog",
            "id": "blog",
            "label": "Select Blog"
          },
          {
            "type": "range",
            "id": "article_limit",
            "label": "Number of articles to show",
            "min": 1,
            "max": 10,
            "step": 1,
            "default": 3
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Multi-blog Homepage",
        "category": "Blog",
        "blocks": [
          {
            "type": "blog_category",
          },
          {
            "type": "blog_category",
          }
        ]
      }
    ]
}
{% endschema %}